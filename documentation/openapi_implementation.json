{
  "openapi": "3.1.0",
  "info": {
    "title": "Quotla AI Document Generator",
    "description": "\n## AI-Powered Invoice & Quote Generator\n\nConvert natural language descriptions, files, or images into structured business documents using AI.\n\n### üéØ Unified API Design\n\n**Two unified endpoints for everything**:\n- `/api/generate` - Generate JSON data from text, files, or images\n- `/api/export` - Export documents in PDF, DOCX, or PNG format\n\n### Key Features\n\n* **Universal Input**: Text, PDF, DOCX, TXT, or images (JPEG, PNG, etc.)\n* **Natural Language Processing**: Describe documents in plain English\n* **Multi-Provider AI**: OpenAI GPT-4, Anthropic Claude, or Google Gemini\n* **Vision AI**: Process scanned receipts and invoice photos\n* **Multiple Export Formats**: JSON, PDF, DOCX, PNG\n* **Conversation History**: Multi-turn conversations to refine documents\n* **AI-Powered Detection**: Automatically determines if input is an invoice or quote\n* **Smart Currency Detection**: Prompts user if currency not specified\n\n### Supported Document Types\n\n* **Invoices**: Full invoicing with tax and delivery charges\n* **Quotes**: Professional quotations with tax calculations\n\n### AI Models Used\n\n* **Text Models**: gpt-4, claude-3-5-sonnet-20241022, gemini-2.0-flash-exp\n* **Vision Models**: gpt-4o, claude-3-5-sonnet-20241022, gemini-2.0-flash-exp\n\nConfigure via `AI_PROVIDER` environment variable.\n\n### Quick Start\n\n**Generate JSON data:**\n```\nPOST /api/generate\n{\"prompt\": \"Invoice for John at Lagos, 100 units at 5000 NGN\"}\n```\n\n**Export as PDF/DOCX/PNG:**\n```\nPOST /api/export\n{\"prompt\": \"...\", \"format\": \"pdf\"}\n```\n    ",
    "contact": {
      "name": "Quotla Support",
      "url": "https://github.com/missiontoscale/quotla"
    },
    "license": {
      "name": "See LICENSE file"
    },
    "version": "2.0.0"
  },
  "paths": {
    "/": {
      "get": {
        "tags": [
          "General"
        ],
        "summary": "API Root",
        "description": "Returns basic API information and version.",
        "operationId": "root__get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {

                }
              }
            }
          }
        }
      }
    },
    "/health": {
      "get": {
        "tags": [
          "General"
        ],
        "summary": "Health Check",
        "description": "Check if the API server is running and healthy. Use this for monitoring and uptime checks.",
        "operationId": "health_health_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {

                }
              }
            }
          }
        }
      }
    },
    "/api/generate": {
      "post": {
        "tags": [
          "Document Generation"
        ],
        "summary": "Universal Document Generator",
        "description": "Generate structured business documents from text prompts, files, or images - all in one unified endpoint.\n\n**Input Methods:**\n1. **Text Prompt Only**: Just provide a prompt in the request body\n2. **File Upload**: Include a file (PDF, DOCX, TXT) with optional prompt\n3. **Image Upload**: Include an image (JPEG, PNG, etc.) with optional prompt\n\n**Supported File Types:**\n- Documents: PDF (.pdf), Word (.docx, .doc), Text (.txt)\n- Images: JPEG, PNG, GIF, BMP, WEBP (uses Vision AI)\n\n**Features:**\n- AI-powered document type detection (invoice vs quote)\n- Intelligent currency detection - prompts if not specified\n- Multi-turn conversation support via history\n- Automatic calculations and enrichment\n- Works with text, documents, and images seamlessly\n\n**AI Models:**\n- Text: GPT-4, Claude 3.5 Sonnet, or Gemini Pro\n- Vision: GPT-4o, Claude 3.5 Sonnet, or Gemini 1.5 Flash\n\n**Example Text Prompt:**\n```json\n{\n  \"prompt\": \"Invoice for John Doe at Lagos. 100 units at 5000 NGN each\"\n}\n```\n\n**Example with File Upload:**\nUse multipart/form-data with:\n- `prompt`: \"Extract invoice data from this PDF\"\n- `file`: [uploaded file]\n- `document_type`: \"invoice\" (optional)\n\n**Response:**\n- `success`: Boolean\n- `document_type`: Detected/specified type\n- `data`: Structured document data\n- `text_output`: Formatted text\n- `needs_currency`: Boolean (if currency required)",
        "operationId": "generate_document_api_generate_post",
        "requestBody": {
          "content": {
            "multipart/form-data": {
              "schema": {
                "$ref": "#/components/schemas/Body_generate_document_api_generate_post"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Structured document data with enriched fields and calculations",
            "content": {
              "application/json": {
                "schema": {

                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/generate/invoice": {
      "post": {
        "tags": [
          "Document Generation (Legacy)"
        ],
        "summary": "[DEPRECATED] Generate Invoice",
        "description": "**‚ö†Ô∏è DEPRECATED: Use `/api/generate` with `document_type=\"invoice\"` instead.**\n\nLegacy endpoint for backward compatibility.\n\n**Same as `/api/generate` but:**\n- Always generates an invoice (never a quote)\n- Includes delivery charges (3% of subtotal)\n- Uses invoice numbering format: INV{timestamp}\n\n**Example:**\n```json\n{\n  \"prompt\": \"John at Lagos for 500 units at 5000 NGN\"\n}\n```",
        "operationId": "generate_invoice_api_generate_invoice_post",
        "requestBody": {
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "$ref": "#/components/schemas/Body_generate_invoice_api_generate_invoice_post"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Invoice data with tax and delivery calculations",
            "content": {
              "application/json": {
                "schema": {

                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/api/generate/quote": {
      "post": {
        "tags": [
          "Document Generation (Legacy)"
        ],
        "summary": "[DEPRECATED] Generate Quote",
        "description": "**‚ö†Ô∏è DEPRECATED: Use `/api/generate` with `document_type=\"quote\"` instead.**\n\nLegacy endpoint for backward compatibility.\n\n**Same as `/api/generate` but:**\n- Always generates a quote (never an invoice)\n- No delivery charges (quotes only include tax)\n- Uses quote numbering format: QT{timestamp}\n\n**Example:**\n```json\n{\n  \"prompt\": \"Jane Smith in Abuja. 50 consulting hours at 15000 NGN per hour\"\n}\n```",
        "operationId": "generate_quote_api_generate_quote_post",
        "requestBody": {
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "$ref": "#/components/schemas/Body_generate_quote_api_generate_quote_post"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Quote data with tax calculations (no delivery)",
            "content": {
              "application/json": {
                "schema": {

                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/api/generate/with-file": {
      "post": {
        "tags": [
          "Document Generation (Legacy)"
        ],
        "summary": "[DEPRECATED] Generate from File",
        "description": "**‚ö†Ô∏è DEPRECATED: Use `/api/generate` with the `file` parameter instead.**\n\nLegacy endpoint for backward compatibility.\n\nSimply use the main `/api/generate` endpoint and include your file - it automatically detects whether you're uploading text, documents, or images.",
        "operationId": "generate_with_file_api_generate_with_file_post",
        "requestBody": {
          "content": {
            "multipart/form-data": {
              "schema": {
                "$ref": "#/components/schemas/Body_generate_with_file_api_generate_with_file_post"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Extracted document data from file",
            "content": {
              "application/json": {
                "schema": {

                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/api/export": {
      "post": {
        "tags": [
          "Export Formats"
        ],
        "summary": "Universal Export (PDF, DOCX, PNG)",
        "description": "Generate document from text, files, or images and download in your preferred format.\n\n**One endpoint for all export formats** - Simply specify the format parameter: 'pdf', 'docx', or 'png'\n\n**Input Methods:**\n- Text prompt only\n- File upload (PDF, DOCX, TXT, images)\n- Combination of prompt + file\n\n**Export Formats:**\n\n1. **PDF (Default)** - `format=pdf`\n   - Professional layout with headers and branding\n   - Formatted tables for line items\n   - Color-coded sections (header, items, totals)\n   - Letter-sized pages (8.5\" √ó 11\")\n   - Use for: Print-ready invoices, professional delivery, accounting records\n\n2. **DOCX (Word)** - `format=docx`\n   - Editable Word document format\n   - Professional table styling with grid borders\n   - Standard Word compatibility\n   - Use for: Editable templates, custom branding, further modifications\n\n3. **PNG (Image)** - `format=png`\n   - 800√ó1000 pixel resolution\n   - Clean white background\n   - Professional typography\n   - Use for: Social media, WhatsApp, quick previews, mobile sharing\n\n**Example:**\n```bash\ncurl -X POST \"http://localhost:8000/api/export\" \\\n  -F \"prompt=Invoice for John at Lagos, 100 units at 5000 NGN\" \\\n  -F \"format=pdf\"\n```\n\n**Response:**\nBinary file in the specified format with appropriate filename (e.g., INV20241201.pdf)",
        "operationId": "export_document_api_export_post",
        "requestBody": {
          "content": {
            "multipart/form-data": {
              "schema": {
                "$ref": "#/components/schemas/Body_export_document_api_export_post"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successfully generated document in requested format",
            "content": {
              "application/json": {
                "schema": {

                }
              },
              "application/pdf": {

              },
              "application/vnd.openxmlformats-officedocument.wordprocessingml.document": {

              },
              "image/png": {

              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/export/pdf": {
      "post": {
        "tags": [
          "Export Formats (Legacy)"
        ],
        "summary": "[DEPRECATED] Export as PDF",
        "description": "**‚ö†Ô∏è DEPRECATED: Use `/api/export` with `format=\"pdf\"` instead.**\n\nLegacy endpoint for backward compatibility.\n\nGenerate document from text, files, or images and download as professionally formatted PDF.\n\n**Input Methods:**\n- Text prompt only\n- File upload (PDF, DOCX, TXT, images)\n- Combination of prompt + file\n\n**Features:**\n- Professional layout with headers and branding\n- Formatted tables for line items\n- Color-coded sections (header, items, totals)\n- Automatic calculations displayed\n- Currency formatting with proper alignment\n- Letter-sized pages (8.5\" √ó 11\")\n\n**Use Cases:**\n- Print-ready invoices\n- Professional client delivery\n- Accounting records\n- Archive storage\n\n**Response:**\nBinary PDF file with appropriate filename (e.g., INV20241201.pdf)",
        "operationId": "export_pdf_api_export_pdf_post",
        "requestBody": {
          "content": {
            "multipart/form-data": {
              "schema": {
                "$ref": "#/components/schemas/Body_export_pdf_api_export_pdf_post"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successfully generated PDF document",
            "content": {
              "application/json": {
                "schema": {

                }
              },
              "application/pdf": {

              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/api/export/docx": {
      "post": {
        "tags": [
          "Export Formats (Legacy)"
        ],
        "summary": "[DEPRECATED] Export as DOCX",
        "description": "**‚ö†Ô∏è DEPRECATED: Use `/api/export` with `format=\"docx\"` instead.**\n\nLegacy endpoint for backward compatibility.\n\nGenerate document from text, files, or images and download as Microsoft Word document.\n\n**Input Methods:**\n- Text prompt only\n- File upload (PDF, DOCX, TXT, images)\n- Combination of prompt + file\n\n**Features:**\n- Editable Word document format (.docx)\n- Professional table styling with grid borders\n- Bold headers and emphasis on totals\n- Standard Word compatibility\n- Preserves formatting for easy customization\n- Ready for further editing and branding\n\n**Use Cases:**\n- Editable templates\n- Custom branding additions\n- Company letterhead integration\n- Further modifications needed\n\n**Benefits:**\n- Fully editable in Microsoft Word, Google Docs, LibreOffice\n- Add logos, signatures, notes after generation\n- Customize colors and fonts\n- Easy to adapt to company style guides\n\n**Response:**\nBinary DOCX file with appropriate filename (e.g., INV20241201.docx)",
        "operationId": "export_docx_api_export_docx_post",
        "requestBody": {
          "content": {
            "multipart/form-data": {
              "schema": {
                "$ref": "#/components/schemas/Body_export_docx_api_export_docx_post"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successfully generated DOCX document",
            "content": {
              "application/json": {
                "schema": {

                }
              },
              "application/vnd.openxmlformats-officedocument.wordprocessingml.document": {

              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "deprecated": true
      }
    },
    "/api/export/png": {
      "post": {
        "tags": [
          "Export Formats (Legacy)"
        ],
        "summary": "[DEPRECATED] Export as PNG Image",
        "description": "**‚ö†Ô∏è DEPRECATED: Use `/api/export` with `format=\"png\"` instead.**\n\nLegacy endpoint for backward compatibility.\n\nGenerate document from text, files, or images and download as PNG image.\n\n**Input Methods:**\n- Text prompt only\n- File upload (PDF, DOCX, TXT, images)\n- Combination of prompt + file\n\n**Image Specifications:**\n- Resolution: 800√ó1000 pixels\n- Format: PNG (lossless)\n- Background: Clean white\n- Professional typography\n- High-quality rendering\n\n**Use Cases:**\n- Social media sharing\n- WhatsApp/messaging apps\n- Quick previews\n- Mobile-friendly format\n- Email attachments\n- Web display\n\n**Benefits:**\n- Universal compatibility\n- No special software needed to view\n- Easy to share on mobile\n- Perfect for instant messaging\n- Lightweight file size\n- Screenshot-like appearance\n\n**Response:**\nBinary PNG image file with appropriate filename (e.g., INV20241201.png)",
        "operationId": "export_png_api_export_png_post",
        "requestBody": {
          "content": {
            "multipart/form-data": {
              "schema": {
                "$ref": "#/components/schemas/Body_export_png_api_export_png_post"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successfully generated PNG image",
            "content": {
              "application/json": {
                "schema": {

                }
              },
              "image/png": {

              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "deprecated": true
      }
    }
  },
  "components": {
    "schemas": {
      "Body_export_document_api_export_post": {
        "properties": {
          "format": {
            "type": "string",
            "title": "Format",
            "description": "Export format: 'pdf', 'docx', or 'png'",
            "default": "pdf"
          },
          "prompt": {
            "type": "string",
            "title": "Prompt"
          },
          "file": {
            "anyOf": [
              {
                "type": "string",
                "format": "binary"
              },
              {
                "type": "null"
              }
            ],
            "title": "File"
          },
          "document_type": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Document Type"
          },
          "history": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "History"
          }
        },
        "type": "object",
        "title": "Body_export_document_api_export_post"
      },
      "Body_export_docx_api_export_docx_post": {
        "properties": {
          "prompt": {
            "type": "string",
            "title": "Prompt"
          },
          "file": {
            "anyOf": [
              {
                "type": "string",
                "format": "binary"
              },
              {
                "type": "null"
              }
            ],
            "title": "File"
          },
          "document_type": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Document Type"
          },
          "history": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "History"
          }
        },
        "type": "object",
        "title": "Body_export_docx_api_export_docx_post"
      },
      "Body_export_pdf_api_export_pdf_post": {
        "properties": {
          "prompt": {
            "type": "string",
            "title": "Prompt"
          },
          "file": {
            "anyOf": [
              {
                "type": "string",
                "format": "binary"
              },
              {
                "type": "null"
              }
            ],
            "title": "File"
          },
          "document_type": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Document Type"
          },
          "history": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "History"
          }
        },
        "type": "object",
        "title": "Body_export_pdf_api_export_pdf_post"
      },
      "Body_export_png_api_export_png_post": {
        "properties": {
          "prompt": {
            "type": "string",
            "title": "Prompt"
          },
          "file": {
            "anyOf": [
              {
                "type": "string",
                "format": "binary"
              },
              {
                "type": "null"
              }
            ],
            "title": "File"
          },
          "document_type": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Document Type"
          },
          "history": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "History"
          }
        },
        "type": "object",
        "title": "Body_export_png_api_export_png_post"
      },
      "Body_generate_document_api_generate_post": {
        "properties": {
          "prompt": {
            "type": "string",
            "title": "Prompt",
            "description": "Text prompt or instructions for extraction"
          },
          "file": {
            "anyOf": [
              {
                "type": "string",
                "format": "binary"
              },
              {
                "type": "null"
              }
            ],
            "title": "File",
            "description": "Optional file upload (PDF, DOCX, TXT, or image)"
          },
          "document_type": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Document Type",
            "description": "Force type: 'invoice' or 'quote' (auto-detected if omitted)"
          },
          "history": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "History",
            "description": "JSON string of conversation history"
          }
        },
        "type": "object",
        "title": "Body_generate_document_api_generate_post"
      },
      "Body_generate_invoice_api_generate_invoice_post": {
        "properties": {
          "prompt": {
            "type": "string",
            "title": "Prompt"
          },
          "history": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "History"
          }
        },
        "type": "object",
        "required": [
          "prompt"
        ],
        "title": "Body_generate_invoice_api_generate_invoice_post"
      },
      "Body_generate_quote_api_generate_quote_post": {
        "properties": {
          "prompt": {
            "type": "string",
            "title": "Prompt"
          },
          "history": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "History"
          }
        },
        "type": "object",
        "required": [
          "prompt"
        ],
        "title": "Body_generate_quote_api_generate_quote_post"
      },
      "Body_generate_with_file_api_generate_with_file_post": {
        "properties": {
          "prompt": {
            "type": "string",
            "title": "Prompt",
            "description": "Instructions for extracting data from the file"
          },
          "file": {
            "type": "string",
            "format": "binary",
            "title": "File",
            "description": "Document or image file (PDF, DOCX, TXT, JPEG, PNG, etc.)"
          },
          "document_type": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Document Type",
            "description": "Force document type: 'invoice' or 'quote' (auto-detected if omitted)"
          }
        },
        "type": "object",
        "required": [
          "prompt",
          "file"
        ],
        "title": "Body_generate_with_file_api_generate_with_file_post"
      },
      "HTTPValidationError": {
        "properties": {
          "detail": {
            "items": {
              "$ref": "#/components/schemas/ValidationError"
            },
            "type": "array",
            "title": "Detail"
          }
        },
        "type": "object",
        "title": "HTTPValidationError"
      },
      "ValidationError": {
        "properties": {
          "loc": {
            "items": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "integer"
                }
              ]
            },
            "type": "array",
            "title": "Location"
          },
          "msg": {
            "type": "string",
            "title": "Message"
          },
          "type": {
            "type": "string",
            "title": "Error Type"
          }
        },
        "type": "object",
        "required": [
          "loc",
          "msg",
          "type"
        ],
        "title": "ValidationError"
      }
    }
  }
}